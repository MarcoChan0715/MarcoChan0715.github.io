<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Subscription Manager App</title>

  <link rel="stylesheet" href="Coursework.css" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    /* ===== App Specific Styles ===== */
    /* Scoped to #sm to avoid conflicts */
    #sm {
      box-sizing: border-box;
      font-family: 'Poppins', sans-serif;
      width: 100%;
      min-height: 80vh; /* Ensure it takes up space */
      padding: 24px 16px 56px;
      /* Semi-transparent background so text is readable over the mountain image */
      background: rgba(255, 255, 255, 0.85); 
      border-radius: 16px;
      margin-top: 20px;
    }

    .app-container {
      max-width: 1100px;
      margin: 0 auto;
    }

    /* Variables for colors */
    :root { --bg: #f6f7f9; --ink: #0f172a; --muted:#64748b; --card:#ffffff; --border:#e5e7eb; --ring:#818cf8; }
    #sm.sm-dark { --bg:#0b1220; --ink:#eef2ff; --muted:#cbd5e1; --card:#0f172a; --border:#23304a; --ring:#60a5fa; background: rgba(11, 18, 32, 0.9); }

    /* Layout Utilities */
    #sm h1 { margin: 0 0 12px; font-size: 26px; font-weight:700; color: var(--ink); }
    #sm p.sm-sub { margin:0; color: var(--muted); font-size:12px; }
    #sm .sm-top { display:flex; gap:12px; align-items:center; justify-content:space-between; flex-wrap:wrap; margin:14px 0 18px; }
    #sm .sm-group { display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
    
    /* Inputs & Cards */
    #sm .sm-input, #sm .sm-select, #sm .sm-textarea {
      background: var(--card); color: var(--ink);
      border:1px solid var(--border); border-radius:12px; padding:10px 12px; font-size:14px;
      outline:none; min-height:40px; width: 100%;
    }
    #sm .sm-card { background: var(--card); border:1px solid var(--border); border-radius:16px; padding:16px; margin-bottom: 20px; box-shadow:0 8px 18px rgba(0,0,0,0.06); }
    
    /* Buttons */
    #sm .sm-btn { border:1px solid var(--border); background: var(--card); color: var(--ink); border-radius:12px; padding:10px 14px; font-weight:600; cursor:pointer; }
    #sm .sm-btn.primary { background: linear-gradient(90deg, #ec4899, #06b6d4); color:#fff; border:0; }
    #sm .sm-btn.red { background:#fee2e2; color:#b91c1c; border-color:#fecaca; }
    
    /* Grid System */
    #sm .sm-row { display:grid; grid-template-columns: repeat(12, 1fr); gap:10px; margin-top: 10px; }
    #sm .col-12 { grid-column: span 12; }
    #sm .col-6 { grid-column: span 6; }
    #sm .col-3 { grid-column: span 3; }
    
    /* Responsive Grid */
    @media (max-width: 800px) { 
        #sm .col-6, #sm .col-3 { grid-column: span 12; } 
    }

    /* FX Grid */
    #sm .fx-grid { display:grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap:10px; margin-bottom: 10px; }
    #sm .fx-item { display:flex; align-items:center; gap:8px; border:1px solid var(--border); background:var(--card); padding:10px; border-radius:12px; }
    
    .logo { width: 150px; }
  </style>
</head>
<body>

  <section id="banner" style="height: auto; min-height: auto; padding-bottom: 20px;">
    <a href="index.html">
      <img src="images/Coursework/Untitled_Artwork.png" class="logo" alt="Logo">
    </a>
    <div class="navbar" style="position: relative; background: transparent; box-shadow: none;">
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="Hobbies.html">Hobbies</a></li>
        <li><a href="Video.html">Video</a></li>
        <li><a href="app.html">App</a></li>
        <li><a href="Clock.html">Clock</a></li>
      </ul>
    </div>
  </section>

  <main class="app-container">
    <div id="sm">
      <div class="sm-top">
        <div>
          <h1>Subscription Manager</h1>
          <p class="sm-sub">Track your recurring payments easily.</p>
        </div>
        <div class="sm-group">
          <label class="sm-label" style="font-size: 12px;">Currency:</label>
          <select id="displayCcy" class="sm-select" style="width:auto;"></select>
          <button id="themeToggle" class="sm-btn">ðŸŒ™ Dark</button>
        </div>
      </div>
      
      <div class="sm-card" style="display:flex; gap:20px; justify-content: space-around; text-align: center;">
        <div>
            <div style="font-size:12px; color:var(--muted);">Monthly Total</div>
            <div id="totMonthly" style="font-size:24px; font-weight:700;">$0.00</div>
        </div>
        <div>
            <div style="font-size:12px; color:var(--muted);">Yearly Total</div>
            <div id="totYearly" style="font-size:24px; font-weight:700;">$0.00</div>
        </div>
      </div>

      <section class="sm-card">
        <h3>Add Subscription</h3>
        <div class="sm-row">
          <div class="col-6">
            <input id="name" class="sm-input" placeholder="Name (e.g. Netflix)" />
          </div>
          <div class="col-3">
            <input id="cost" type="number" class="sm-input" placeholder="Price" />
          </div>
          <div class="col-3">
            <select id="currency" class="sm-select"></select>
          </div>
          <div class="col-6">
            <select id="cycle" class="sm-select">
              <option value="monthly">Monthly</option>
              <option value="yearly">Yearly</option>
            </select>
          </div>
           <div class="col-6">
            <input id="startDate" type="date" class="sm-input" />
          </div>
        </div>
        <button id="addBtn" class="sm-btn primary" style="margin-top: 15px; width: 100%;">+ Add Subscription</button>
      </section>

      <section class="sm-card">
        <h3>Active Subscriptions (<span id="countActive">0</span>)</h3>
        <div id="activeList"></div>
      </section>
      
      <section class="sm-card">
        <h3>FX Rates</h3>
         <div id="fxGrid" class="fx-grid"></div>
         <button id="fxUpdate" class="sm-btn">Update Rates</button>
      </section>

    </div>
  </main>

  <script>
  (function(){
    const $ = (id) => document.getElementById(id);
    const K_SUBS = 'sm:subs:v2';
    const DEFAULT_FX = { USD:1, GBP:0.77, EUR:0.92, HKD:7.8, JPY:157 };
    
    let subs = JSON.parse(localStorage.getItem(K_SUBS) || '[]');
    let fx = DEFAULT_FX;
    let display = 'USD';

    function save(){ localStorage.setItem(K_SUBS, JSON.stringify(subs)); }
    
    function fmtMoney(n, ccy){ 
        return new Intl.NumberFormat('en-US', { style: 'currency', currency: ccy }).format(n);
    }

    function convert(amount, src, dest){ 
        const s = fx[src] || 1; 
        const d = fx[dest] || 1; 
        return (amount / s) * d; 
    }

    function render(){
        const list = $('activeList');
        list.innerHTML = '';
        let mTotal = 0;
        let yTotal = 0;

        subs.forEach((s, index) => {
            const val = convert(s.cost, s.currency, display);
            if(s.cycle === 'monthly') { mTotal += val; yTotal += val * 12; }
            else { mTotal += val / 12; yTotal += val; }

            const div = document.createElement('div');
            div.style.cssText = "display:flex; justify-content:space-between; padding: 10px; border-bottom:1px solid #eee;";
            div.innerHTML = `
                <div><strong>${s.name}</strong> <br> <small>${s.cost} ${s.currency} / ${s.cycle}</small></div>
                <div>${fmtMoney(val, display)} <button onclick="window.delSub(${index})" style="color:red; border:none; background:none; cursor:pointer;">&times;</button></div>
            `;
            list.appendChild(div);
        });

        $('totMonthly').innerText = fmtMoney(mTotal, display);
        $('totYearly').innerText = fmtMoney(yTotal, display);
        $('countActive').innerText = subs.length;
        
        // Populate Selects
        const opts = Object.keys(fx).map(c => `<option value="${c}">${c}</option>`).join('');
        if($('currency').innerHTML === '') $('currency').innerHTML = opts;
        if($('displayCcy').innerHTML === '') { $('displayCcy').innerHTML = opts; $('displayCcy').value = 'USD'; }
    }

    // Event Listeners
    $('addBtn').addEventListener('click', () => {
        const name = $('name').value;
        const cost = parseFloat($('cost').value);
        if(!name || !cost) return alert('Please enter name and cost');
        
        subs.push({
            name, 
            cost, 
            currency: $('currency').value, 
            cycle: $('cycle').value,
            date: $('startDate').value
        });
        save();
        render();
        $('name').value = ''; $('cost').value = '';
    });

    $('displayCcy').addEventListener('change', (e) => { display = e.target.value; render(); });

    // Global delete function
    window.delSub = function(index) {
        if(confirm('Delete this subscription?')) {
            subs.splice(index, 1);
            save();
            render();
        }
    };

    // Initial Render
    render();
  })();
  </script>
</body>
</html>
